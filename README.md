# Foodgram

Учебный проект, фронтенд полностью и без изменений - материал курса Яндекс.Практикума, бэкэнд с нуля  писала студентка [**Ди На Пак**](https://github.com/Nenfind).

Фудграм - это простое и красивое SPA, которое позволяет пользователям создавать рецепты и делиться ими, добавлять рецепты в корзину и скачивать их в виде списка покупок, следить за рецептами других пользователей и искать с помощью тэгов то, что придётся им по вкусу. 

## Стек технологий:

### Backend:

 - Python 3.12
 - Django 5.1
 - Django REST Framework (DRF)
   
### База данных:

 - PostgreSql
   
### Аутентификация:

 - Djoser + JWT (JSON Web Token)
   
### Картинки:

 - Base64Image

Для того, чтобы развернуть приложение на своём сервере, вам понадобится создать и заполнить файл .env (пример - файл .env.example), создать на гитхабе переменные, используемые в main.yml, поменять в файле docker-compose.production.yml хаб, откуда скачивать images и скрестить пальцы - воркфлоу настроен так, что должен сам сделать большую часть работы. Что ещё понадобится помимо того, что развернётся автоматически: 
- Внешний Nginx, передающий сигналы на порт 8000
- https сертификация (CertBot)
- Удача

### Возможные частые ошибки/проблемы:
##### Нет прав на папки с проектом/статикой проекта/медиа проекта:

`sudo chown -R юзернейм_пользователя_ОС абсолютный_путь_до_папки`

##### Изменили nginx conf/прикрутили сертификат но ничего не поменялось:  

`sudo nginx -t` - проверить конфиг на корректность  
`sudo systemctl reload nginx` - перезапустить nginx  

##### Не знаю как теперь запустить что-то из моего законтейнеренного бэка:  

`sudo docker exec -it foodgram-backend python manage.py ваша_команда`

### Полезные инструменты, включённые в репо:  

##### Автотесты с помощью постмана:  

Готовая коллекция лежит в папке postman_collection, там же лежит скрипт на очистку датабазы до/после запуска коллекции, запустить скрипт можно командой `bash clear_db.sh` из той же директории.  
Внимание! Тесты в коллекции зависят друг от друга, а значит, если упал один - из-за него могут посыпаться другие и не по причине того, что проверяемый функционал неправильно работает.  
Возможно, когда-нибудь я покрою всё красивыми идемпотентными и независимыми тестами, но работа оказалась и без того огромной :<

##### Заполнение базы данных подготовленными данными:  

Сами данные в формате Json лежат в папке backend/data, данные можно дополнять но важно чтобы все названия полей точно совпадали с ожидаемыми в базе данных (ленивый создатель скрипта не сделал никаких проверок, поскольку ему нужно было один раз заполнить бд). Скрипт вызывается командой `sudo docker exec -it foodgram-backend python manage.py import_ingredients` из уже запакованного в контейнер бэкэнда, сам скрипт лежит по адресу backend/recipes/management/commands. В проекте лежит заготовка для import_tags, можно по аналогии легко расширить заготовки другими моделями.

##### Документация:  

В режиме дебага документация доступна по адресу 'your_host/api/redoc/', схема лежит в папке backend/static.

На этом пока всё! Приятного пользования. 
